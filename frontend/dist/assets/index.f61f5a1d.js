import{q as e,c as t,r,b as a,C as n,d as c,n as l,i as s,a as i}from"./vendor.1e6a04de.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(r){const a=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((r,c)=>{const l=new URL(e,a);if(self[t].moduleMap[l])return r(self[t].moduleMap[l]);const s=new Blob([`import * as m from '${l}';`,`${t}.moduleMap['${l}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(s),onerror(){c(new Error(`Failed to import: ${e}`)),n(i)},onload(){r(self[t].moduleMap[l]),n(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/assets/");const o=e.div`
  box-shadow: 0 0 48px ${t.coolGray[800]};
`,m=e.div`
  background: linear-gradient(to top, rgba(0, 0, 0, 0.36), transparent 25%);
`,d=({children:e,bottom:t,className:a})=>r.createElement(o,{className:`sm:w-[16rem] sm:h-[18rem] rounded-md bg-gray-800 text-gray-300 overflow-hidden flex flex-col ${a}`},r.createElement("div",{className:"flex-1 flex relative"},r.createElement("div",{className:"flex-1"},e),r.createElement(m,{className:"absolute inset-0 z-50"})),r.createElement("div",{className:"flex-none bg-gray-700"},t)),h=["1.jpg","2.jpg","3.jpg"],f=e=>{const t=r.useMemo((()=>Math.floor(Math.random()*h.length)),[]);return r.createElement("img",{src:`/images/${h[t]}`,alt:"An image of a lovely cat ;)",...e})},u=({className:e,message:t})=>r.createElement(d,{className:e,bottom:r.createElement("div",{className:"p-2 text-center text-sm"},t)},r.createElement("div",{className:"h-full flex relative"},r.createElement(f,{className:"block flex-1"})));const E=new class{constructor(){this.target=new EventTarget}addEventListener(e,t){this.target.addEventListener(e,t)}removeEventListener(e,t){this.target.removeEventListener(e,t)}debug(...e){console.debug(...e),this.target.dispatchEvent(new CustomEvent("new-log",{detail:this.handleMessage("debug",e)}))}info(...e){console.info(...e),this.target.dispatchEvent(new CustomEvent("new-log",{detail:this.handleMessage("info",e)}))}error(...e){console.error(...e),this.target.dispatchEvent(new CustomEvent("new-log",{detail:this.handleMessage("error",e)}))}handleMessage(e,t){return{level:e,line:t.map((e=>"object"==typeof e?JSON.stringify(e):e)).join(" ")}}};function p(e,t){e.onicecandidate=({candidate:e})=>{e&&(E.debug("[bootstrap-ice] new candidate:",e),t.emit("SIGNAL_CANDIDATE",{candidate:e}))},t.on("SIGNAL_CANDIDATE",(async({candidates:t})=>{E.debug("[bootstrap-ice] got remote candidates:",t);for(const r of t)await e.addIceCandidate(r)}))}function v(e){const{servers:t=[]}=e;return new RTCPeerConnection({iceServers:t.map((e=>({urls:e.url,username:e.username,credential:e.credential})))})}const x={protocol:"junjun-transfer/v1",ordered:!0};class g{constructor(e){this.signalSocket=e,this.target=new EventTarget}addEventListener(e,t){this.target.addEventListener(e,t)}removeEventListener(e,t){this.target.removeEventListener(e,t)}async bootstrap(e){try{await this.initDataChannel(e)}catch(t){E.error("[sender-connection-bootstrap] error bootstrapping:",t)}}async initDataChannel(e){this.connection=v(e),this.channel=function(e){const t=e.createDataChannel("dataChannel",x);return t.binaryType="arraybuffer",t}(this.connection),this.channel.onopen=()=>{E.info("[sender-connection-bootstrap] channel established"),this.target.dispatchEvent(new CustomEvent("channel-open",{detail:{connection:this.connection,channel:this.channel}}))},p(this.connection,this.signalSocket),this.signalSocket.on("SIGNAL_ANSWER",(async({answer:e})=>{E.info("[sender-connection-bootstrap] received answer:",e),this.target.dispatchEvent(new CustomEvent("answer-received")),await this.connection.setRemoteDescription(new RTCSessionDescription(e))}));const t=await this.connection.createOffer();await this.connection.setLocalDescription(t),this.signalSocket.emit("SIGNAL_OFFER",{offer:t})}}const y=({children:e,className:t,...a})=>r.createElement("div",{className:`sm:w-[16rem] sm:h-[18rem] text-center border-dashed border-4 rounded-md border-gray-500 bg-gray-800 p-2 flex flex-col justify-around ${t}`,...a},e),w=({primary:e=!1,children:t,...a})=>r.createElement("button",{...a,className:`text-sm font-light p-2 transition-colors !outline-none \n        ${a.disabled?"cursor-not-allowed text-gray-500 border-gray-500":"border-gray-400 text-gray-300 "+(e?"hover:bg-cyan-600":"hover:bg-gray-300 hover:text-gray-800")}\n        ${a.className}\n      `},t),b=({url:e,className:t})=>{const[c,l]=r.useState(!1),[s,i]=r.useState(null),o=r.useRef();return r.useEffect((async()=>{const t=await a.toDataURL(e,{type:"image/jpeg",quality:.3,margin:1});i(t)}),[e]),r.useEffect((()=>{o&&(o.current.scrollLeft=o.current.scrollWidth)}),[e]),r.createElement(y,{className:`text-sm text-gray-300 ${t}`},r.createElement("p",{className:"mb-2"},"为了让你的小伙伴能够收到文件，请让TA扫描下方二维码："),r.createElement("div",{className:"flex justify-center mb-2"},r.createElement("img",{src:s,className:"max-w-full max-h-full"})),r.createElement("p",null,"或者让TA用浏览器打开下面的链接："),r.createElement("div",{className:"flex"},r.createElement("input",{type:"text",className:"rounded-tl rounded-bl border-solid border-2 border-r-0 border-gray-500 bg-gray-800 flex-1 px-2 py-1 w-0 font-light",disabled:!0,value:e,ref:o}),r.createElement(n.CopyToClipboard,{text:e,onCopy:()=>l(!0)},r.createElement(w,{className:"flex-none rounded-tr rounded-br border-solid border-2 border-l-0 !border-gray-500 hover:!border-gray-300 px-2 py-1"},c?"OK":"复制"))))},C=e.div`
  position: relative;

  &::before {
    content: '';
    position: absolute;
    height: 100%;
    left: 0;
    right: ${({progress:e})=>100-e}%;
    background: ${t.cyan[600]};
    transition-property: right;
    transition-duration: ${c.theme.transitionDuration.DEFAULT};
    transition-timing-function: ${c.theme.transitionTimingFunction.DEFAULT};
  }
`,N=({progress:e=0,children:t})=>r.createElement(C,{progress:e},r.createElement("div",{className:"relative z-10"},t));function F(e){return e<1024?`${e} Bytes`:(e/=1024)<1024?`${e.toFixed(2)} KiB`:(e/=1024)<1024?`${e.toFixed(2)} MiB`:`${e.toFixed(2)} GiB`}function L(e){return`${F(e)}/s`}function M(e){return r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",className:"w-28 h-28 sm:w-36 sm:h-36","aria-hidden":"true",role:"img",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},e)}const S=M(r.createElement("path",{d:"M13 9h5.5L13 3.5V9M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4c0-1.11.89-2 2-2m9 16v-2H6v2h9m3-4v-2H6v2h12z",fill:"currentColor"})),B={"image/":M(r.createElement("path",{d:"M13 9h5.5L13 3.5V9M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4c0-1.11.89-2 2-2m0 18h12v-8l-4 4l-2-2l-6 6M8 9a2 2 0 0 0-2 2a2 2 0 0 0 2 2a2 2 0 0 0 2-2a2 2 0 0 0-2-2z",fill:"currentColor"})),"video/":M(r.createElement("path",{d:"M13 9h5.5L13 3.5V9M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4c0-1.11.89-2 2-2m11 17v-6l-3 2.2V13H7v6h7v-2.2l3 2.2z",fill:"currentColor"})),"application/pdf":M(r.createElement("path",{d:"M13 9h5.5L13 3.5V9M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m4.1 9.4c-.02.04-.29 1.76-2.1 4.69c0 0-3.5 1.82-2.67 3.18c.67 1.08 2.32-.04 3.74-2.68c0 0 1.82-.64 4.24-.82c0 0 3.86 1.73 4.39-.11c.52-1.86-3.06-1.44-3.7-1.25c0 0-2-1.35-2.5-3.21c0 0 1.14-3.95-.61-3.9c-1.75.05-1.09 3.13-.79 4.1m.81 1.04c.03.01.47 1.21 1.89 2.46c0 0-2.33.46-3.39.9c0 0 1-1.73 1.5-3.36m3.93 2.72c.58-.16 2.33.15 2.26.48c-.06.33-2.26-.48-2.26-.48M7.77 17c-.53 1.24-1.44 2-1.67 2c-.23 0 .7-1.6 1.67-2m3.14-6.93c0-.07-.36-2.2 0-2.15c.54.08 0 2.08 0 2.15z",fill:"currentColor"})),"application/zip":M(r.createElement("path",{d:"M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m-2 6h-2v2h2v2h-2v2h-2v-2h2v-2h-2v-2h2v-2h-2V8h2v2h2v2z",fill:"currentColor"}))},k=({fileType:e})=>r.useMemo((()=>{if(!e)return S;const t=Object.keys(B).find((t=>e.startsWith(t)));return t?B[t]:S}),[e]),z=({name:e,size:t=0,type:a="",children:n})=>r.createElement("div",{className:"h-full flex flex-col justify-evenly items-center text-center p-2"},r.createElement(k,{fileType:a}),r.createElement("div",{className:"text-sm"},r.createElement("p",{className:"max-h-[4rem] overflow-hidden"},e),r.createElement("p",{className:"text-xs sm:text-sm font-mono"},a),r.createElement("p",{className:"text-xs sm:text-sm font-mono"},F(t)),n)),D=({className:e,fileName:t,receivedSize:a,type:n,progress:c,speed:l,avgSpeed:s})=>{const i=r.useMemo((()=>L(l)),[l]),o=r.useMemo((()=>L(s)),[l]);return r.createElement(d,{className:e,bottom:r.createElement(N,{progress:c},r.createElement("div",{className:"text-center px-0.5 py-1"},r.createElement("p",{className:"text-xs sm:text-sm"},c<100?"接收中":"接收完成"),r.createElement("p",{className:"text-xs font-mono"},c<100&&i,c>=100&&o)))},r.createElement(z,{name:t,size:a,type:n}))};class R{constructor(e,t){var r;this.dataChannel=t,this.chunkSize=Math.min((null==(r=e.sctp)?void 0:r.maxMessageSize)||16384,16384),this.dataChannel.bufferedAmountLowThreshold=this.chunkSize,this.highWaterMark=8*this.chunkSize,this.reset(),this.stateUpdateHandle=setTimeout((()=>this.doStateUpdate()),500)}destroy(){clearTimeout(this.stateUpdateHandle),this.reset()}send(e){return new Promise((async(t,r)=>{try{await this.doSend(e,t)}catch(a){r(a)}}))}async doSend(e,t){if(this.currentArrayBuffer)throw new Error("[data-channel-transmitter] previous array buffer is still under transmission");this.reset(e,t),this.dataChannel.onbufferedamountlow=()=>this.doSendDataLoop(),this.doSendDataLoop()}doSendDataLoop(){let e=this.dataChannel.bufferedAmount;for(;this.bytesTransmitted<this.totalBytes;){const t=Math.min(this.chunkSize,this.totalBytes-this.bytesTransmitted),r=new Uint8Array(this.currentArrayBuffer,this.bytesTransmitted,t);if(this.dataChannel.send(r),this.bytesTransmitted+=t,e+=t,e>=this.highWaterMark)break}}doStateUpdate(){this.checkCompleted(),this.stateUpdateHandle=setTimeout((()=>this.doStateUpdate()),500)}checkCompleted(){this.currentArrayBuffer&&this.dataChannel.bufferedAmount<=0&&this.bytesTransmitted===this.totalBytes&&(E.debug(`[data-channel-transmitter] successfully sent ${this.bytesTransmitted}bytes`),console.assert(this.currentResolve),this.currentResolve(),this.reset())}reset(e=null,t=null){this.currentArrayBuffer=e,this.currentResolve=t,this.bytesTransmitted=0,this.totalBytes=null==e?void 0:e.byteLength}}function A(e){const t=new ArrayBuffer(16384);new Uint8Array(t).fill(0);const r=JSON.stringify(e),a=(new TextEncoder).encode(r);return console.assert(a.byteLength<16384),function(e,t,r){const a=new Uint8Array(e),n=new Uint8Array(t);for(let c=0;c<r;c++)n[c]=a[c]}(a,t,a.byteLength),t}function T(e){const t=new TextDecoder,r=function(e){const t=new Uint8Array(e).indexOf(0);return new Uint8Array(e,0,t)}(e);return JSON.parse(t.decode(r))}class j{constructor(e,t){this.transmitter=new R(e,t)}async send(e){const t=await e.arrayBuffer(),r={size:t.byteLength,name:e.name,type:e.type};E.info("[file-sender] sending meta",r),await this.transmitter.send(A(r)),E.info("[file-sender] sending file"),await this.transmitter.send(t)}}const U=({file:e,canSend:t,sending:a,onConfirm:n,onCancel:c,className:l})=>{const s=r.useMemo((()=>F(e.size).endsWith("GiB")?"文件过大，传输可能不稳定":null),[e.size]);return r.createElement(d,{className:l,bottom:r.createElement("div",{className:"w-full flex"},r.createElement(w,{className:"flex-1 rounded-bl-md",onClick:c,disabled:a},r.createElement("span",{className:"inline-flex self-center pr-1"},r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",className:"relative top-[0.125em]",width:"1em",height:"1em","aria-hidden":"true",role:"img",preserveAspectRatio:"xMidYMid meet",viewBox:"0 -1 25 25"},r.createElement("path",{d:"M22 3H7c-.69 0-1.23.35-1.59.88L0 12l5.41 8.11c.36.53.9.89 1.59.89h15a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-3 12.59L17.59 17L14 13.41L10.41 17L9 15.59L12.59 12L9 8.41L10.41 7L14 10.59L17.59 7L19 8.41L15.41 12",fill:"currentColor"}))),"返回"),r.createElement(w,{primary:!0,className:"flex-1 rounded-br-md",onClick:n,disabled:a||!t},r.createElement("span",{className:"inline-flex self-center pr-1"},r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",className:"relative top-[0.125em]",width:"1em",height:"1em","aria-hidden":"true",role:"img",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},r.createElement("path",{d:"M2 21l21-9L2 3v7l15 2l-15 2v7z",fill:"currentColor"}))),"发送"))},r.createElement(z,{name:e.name,size:e.size,type:e.type},s&&r.createElement("p",{className:"text-sm mb-2"},r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",className:"h-4 inline mr-1","aria-hidden":"true",role:"img",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 26 26"},r.createElement("path",{d:"M1 21h22L12 2L1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z",fill:"currentColor"})),r.createElement("span",null,s))))},I=({onSelectFile:e,className:t})=>{const a=r.useCallback((t=>{var r;t.preventDefault();const{dataTransfer:a}=t,n=null==(r=null==a?void 0:a.items)?void 0:r[0];"file"===(null==n?void 0:n.kind)&&e(n.getAsFile())}),[]);return r.createElement(y,{className:`relative ${t}`},r.createElement("input",{type:"file",id:"file",hidden:!0,onChange:t=>e(t.target.files[0])}),r.createElement("label",{htmlFor:"file",className:"opacity-0 absolute inset-0 cursor-pointer",onDrop:a,onDragOver:e=>e.preventDefault()}),r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",className:"text-gray-300",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},r.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z",fill:"currentColor"})),r.createElement("h3",{className:"text-gray-300 cursor-text z-10 text-sm"},"将要上传的文件用鼠标拖到这里，或者直接点击这里的加号来选择文件！"))},$=({className:e,message:t})=>r.createElement(y,{className:e},r.createElement("div",{className:"flex flex-col items-center px-2 py-8"},r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",className:"h-24 w-24 block mb-2","aria-hidden":"true",role:"img",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 36 36"},r.createElement("path",{fill:"#FFCC4D",d:"M36 18c0 9.941-8.059 18-18 18c-9.94 0-18-8.059-18-18C0 8.06 8.06 0 18 0c9.941 0 18 8.06 18 18"}),r.createElement("ellipse",{fill:"#664500",cx:"11.5",cy:"16.5",rx:"2.5",ry:"3.5"}),r.createElement("ellipse",{fill:"#664500",cx:"24.5",cy:"16.5",rx:"2.5",ry:"3.5"}),r.createElement("path",{fill:"#664500",d:"M23.485 27.879C23.474 27.835 22.34 23.5 18 23.5s-5.474 4.335-5.485 4.379a.496.496 0 0 0 .232.544a.51.51 0 0 0 .596-.06c.009-.007 1.013-.863 4.657-.863c3.59 0 4.617.83 4.656.863a.496.496 0 0 0 .59.073a.5.5 0 0 0 .239-.557z"}),r.createElement("path",{fill:"#5DADEC",d:"M10 30c0 2.762-2.238 5-5 5s-5-2.238-5-5s4-10 5-10s5 7.238 5 10z"}),r.createElement("path",{fill:"#664500",d:"M30 13c-5.554 0-7.802-4.367-7.895-4.553a1 1 0 0 1 1.787-.899C23.967 7.694 25.713 11 30 11a1 1 0 1 1 0 2zM6 13a1 1 0 0 1 0-2c5.083 0 5.996-3.12 6.033-3.253c.145-.528.69-.848 1.219-.709c.53.139.851.673.718 1.205C13.921 8.437 12.704 13 6 13z"})),r.createElement("p",{className:"text-gray-300 font-bold text-xl mb-2"},"出错了"),r.createElement("p",{className:"text-gray-300 text-sm sm:text-base"},t))),V=({socket:e,jobId:t,serversInfo:a,errorMessage:n})=>{const[c,l]=r.useState(null),[s,i]=r.useState(null),[o,m]=r.useState("initial"),[d,h]=r.useState({speed:0,progress:0,current:0}),f=r.useMemo((()=>{const e=new URL(window.location.href);return e.searchParams.set("id",t),e.toString()}),[t]),E=r.useCallback((()=>{m("transferring"),s.send(c)}),[c,s]);return r.useEffect((()=>{const t=new g(e);t.addEventListener("answer-received",(()=>m("connected"))),t.addEventListener("channel-open",(({detail:{connection:e,channel:t}})=>{i(new j(e,t)),m("ready")})),t.bootstrap(a).then((()=>e.connect()))}),[]),r.useEffect((()=>{s&&e&&e.on("EVENT_RECEIVER_PROGRESS",(({avgSpeed:e,speed:t,current:r,goal:a})=>{h({speed:t,avgSpeed:e,progress:Math.floor(100*r/a),current:r}),r===a&&m("completed")}))}),[s,e]),r.createElement("main",{className:"p-2 grid grid-cols-2 grid-rows-1 gap-4"},r.createElement("div",{className:"flex flex-col items-center"},r.createElement("h4",{className:"text-gray-200 font-zcool text-3xl tracking-widest mb-2 xl:mb-4"},"发送文件"),!c&&r.createElement(I,{className:"flex-1 w-full",onSelectFile:e=>{e.size>0&&l(e)}}),c&&r.createElement(U,{className:"flex-1 w-full",file:c,canSend:!!s,sending:"transferring"===o,onCancel:()=>{"completed"===o&&m("ready"),l(null)},onConfirm:E})),r.createElement("div",{className:"flex flex-col items-center"},r.createElement("h4",{className:"text-gray-200 font-zcool text-3xl tracking-widest mb-2 xl:mb-4"},"接收文件"),!n&&r.createElement(r.Fragment,null,"initial"===o&&r.createElement(b,{className:"flex-1",url:f}),"connected"===o&&r.createElement(u,{className:"flex-1",message:"伙伴已经打开了俊俊快传，浏览器正在建立 WebRTC 连接..."}),"ready"===o&&r.createElement(u,{className:"flex-1",message:"伙伴已经连接到你的浏览器，就等你选好文件开始发送了！"}),("transferring"===o||"completed"===o)&&r.createElement(D,{className:"flex-1",fileName:c.name,receivedSize:d.current,type:c.type,progress:d.progress,speed:d.speed,avgSpeed:d.avgSpeed})),n&&r.createElement($,{className:"flex-1 w-full",message:n})))};const O={closeOnBeforeunload:!1,autoConnect:!1};function _(e){return r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 36 36"},e)}const H=[_(r.createElement(r.Fragment,null,r.createElement("circle",{fill:"#FFD983",cx:"18",cy:"18",r:"18"}),r.createElement("g",{fill:"#FFCC4D"},r.createElement("circle",{cx:"10.5",cy:"8.5",r:"3.5"}),r.createElement("circle",{cx:"20",cy:"17",r:"3"}),r.createElement("circle",{cx:"24.5",cy:"28.5",r:"3.5"}),r.createElement("circle",{cx:"22",cy:"5",r:"2"}),r.createElement("circle",{cx:"3",cy:"18",r:"1"}),r.createElement("circle",{cx:"30",cy:"9",r:"1"}),r.createElement("circle",{cx:"15",cy:"31",r:"1"}),r.createElement("circle",{cx:"32",cy:"19",r:"2"}),r.createElement("circle",{cx:"10",cy:"23",r:"2"})))),_(r.createElement(r.Fragment,null,r.createElement("path",{fill:"#FFD983",d:"M0 18c0 9.941 8.059 18 18 18c.295 0 .58-.029.87-.043C24.761 33.393 29 26.332 29 18C29 9.669 24.761 2.607 18.87.044C18.58.03 18.295 0 18 0C8.059 0 0 8.059 0 18z"}),r.createElement("path",{fill:"#66757F",d:"M29 18C29 9.669 24.761 2.607 18.87.044C28.404.501 36 8.353 36 18c0 9.646-7.594 17.498-17.128 17.956C24.762 33.391 29 26.331 29 18z"}),r.createElement("circle",{fill:"#FFCC4D",cx:"10.5",cy:"8.5",r:"3.5"}),r.createElement("circle",{fill:"#FFCC4D",cx:"20",cy:"16",r:"3"}),r.createElement("circle",{fill:"#FFCC4D",cx:"21.5",cy:"27.5",r:"3.5"}),r.createElement("circle",{fill:"#FFCC4D",cx:"21",cy:"6",r:"2"}),r.createElement("circle",{fill:"#FFCC4D",cx:"3",cy:"18",r:"1"}),r.createElement("circle",{fill:"#5B6876",cx:"30",cy:"9",r:"1"}),r.createElement("circle",{fill:"#FFCC4D",cx:"15",cy:"31",r:"1"}),r.createElement("circle",{fill:"#5B6876",cx:"32",cy:"19",r:"2"}),r.createElement("circle",{fill:"#FFCC4D",cx:"10",cy:"23",r:"2"}))),_(r.createElement(r.Fragment,null,r.createElement("path",{fill:"#FFD983",d:"M18 0v36C8.059 36 0 27.941 0 18S8.059 0 18 0z"}),r.createElement("path",{fill:"#66757F",d:"M36 18c0 9.941-8.059 18-18 18V0c9.941 0 18 8.059 18 18z"}),r.createElement("circle",{fill:"#FFCC4D",cx:"10.5",cy:"8.5",r:"3.5"}),r.createElement("circle",{fill:"#5B6876",cx:"24",cy:"16",r:"3"}),r.createElement("circle",{fill:"#5B6876",cx:"22.5",cy:"27.5",r:"3.5"}),r.createElement("circle",{fill:"#5B6876",cx:"21",cy:"6",r:"2"}),r.createElement("circle",{fill:"#FFCC4D",cx:"3",cy:"18",r:"1"}),r.createElement("circle",{fill:"#5B6876",cx:"30",cy:"9",r:"1"}),r.createElement("circle",{fill:"#FFCC4D",cx:"15",cy:"31",r:"1"}),r.createElement("circle",{fill:"#5B6876",cx:"32",cy:"19",r:"2"}),r.createElement("circle",{fill:"#FFCC4D",cx:"10",cy:"23",r:"2"}))),_(r.createElement(r.Fragment,null,r.createElement("circle",{fill:"#FFD983",cx:"18",cy:"18",r:"18"}),r.createElement("path",{fill:"#66757F",d:"M36 18c0 9.941-8.059 18-18 18c-.294 0-.58-.029-.87-.043C11.239 33.393 7 26.332 7 18C7 9.669 11.239 2.607 17.13.044C17.42.03 17.706 0 18 0c9.941 0 18 8.059 18 18z"}),r.createElement("circle",{fill:"#5B6876",cx:"25.5",cy:"8.5",r:"3.5"}),r.createElement("circle",{fill:"#5B6876",cx:"16",cy:"16",r:"3"}),r.createElement("circle",{fill:"#5B6876",cx:"14.5",cy:"27.5",r:"3.5"}),r.createElement("circle",{fill:"#5B6876",cx:"15",cy:"6",r:"2"}),r.createElement("circle",{fill:"#5B6876",cx:"33",cy:"18",r:"1"}),r.createElement("circle",{fill:"#FFCC4D",cx:"6",cy:"9",r:"1"}),r.createElement("circle",{fill:"#5B6876",cx:"21",cy:"31",r:"1"}),r.createElement("circle",{fill:"#FFCC4D",cx:"4",cy:"19",r:"2"}),r.createElement("circle",{fill:"#5B6876",cx:"26",cy:"23",r:"2"}))),_(r.createElement(r.Fragment,null,r.createElement("circle",{fill:"#66757F",cx:"18",cy:"18",r:"18"}),r.createElement("g",{fill:"#5B6876"},r.createElement("circle",{cx:"10.5",cy:"8.5",r:"3.5"}),r.createElement("circle",{cx:"20",cy:"16",r:"3"}),r.createElement("circle",{cx:"21.5",cy:"27.5",r:"3.5"}),r.createElement("circle",{cx:"21",cy:"6",r:"2"}),r.createElement("circle",{cx:"3",cy:"18",r:"1"}),r.createElement("circle",{cx:"30",cy:"9",r:"1"}),r.createElement("circle",{cx:"15",cy:"31",r:"1"}),r.createElement("circle",{cx:"32",cy:"19",r:"2"}),r.createElement("circle",{cx:"10",cy:"23",r:"2"})))),_(r.createElement(r.Fragment,null,r.createElement("circle",{fill:"#FFD983",cx:"18",cy:"18",r:"18"}),r.createElement("path",{fill:"#66757F",d:"M0 18c0 9.941 8.059 18 18 18c.295 0 .58-.029.87-.043C24.761 33.393 29 26.332 29 18C29 9.669 24.761 2.607 18.87.044C18.58.03 18.295 0 18 0C8.059 0 0 8.059 0 18z"}),r.createElement("circle",{fill:"#5B6876",cx:"10.5",cy:"8.5",r:"3.5"}),r.createElement("circle",{fill:"#5B6876",cx:"20",cy:"16",r:"3"}),r.createElement("circle",{fill:"#5B6876",cx:"21.5",cy:"27.5",r:"3.5"}),r.createElement("circle",{fill:"#5B6876",cx:"21",cy:"6",r:"2"}),r.createElement("circle",{fill:"#5B6876",cx:"3",cy:"18",r:"1"}),r.createElement("circle",{fill:"#FFCC4D",cx:"30",cy:"9",r:"1"}),r.createElement("circle",{fill:"#5B6876",cx:"15",cy:"31",r:"1"}),r.createElement("circle",{fill:"#FFCC4D",cx:"32",cy:"19",r:"2"}),r.createElement("circle",{fill:"#5B6876",cx:"10",cy:"23",r:"2"}))),_(r.createElement(r.Fragment,null,r.createElement("path",{fill:"#FFD983",d:"M18 0v36c9.941 0 18-8.059 18-18S27.941 0 18 0z"}),r.createElement("path",{fill:"#66757F",d:"M0 18c0 9.941 8.059 18 18 18V0C8.059 0 0 8.059 0 18z"}),r.createElement("circle",{fill:"#FFCC4D",cx:"25.5",cy:"8.5",r:"3.5"}),r.createElement("circle",{fill:"#5B6876",cx:"12",cy:"16",r:"3"}),r.createElement("circle",{fill:"#5B6876",cx:"13.5",cy:"27.5",r:"3.5"}),r.createElement("circle",{fill:"#5B6876",cx:"15",cy:"6",r:"2"}),r.createElement("circle",{fill:"#FFCC4D",cx:"33",cy:"18",r:"1"}),r.createElement("circle",{fill:"#5B6876",cx:"6",cy:"9",r:"1"}),r.createElement("circle",{fill:"#FFCC4D",cx:"21",cy:"31",r:"1"}),r.createElement("circle",{fill:"#5B6876",cx:"4",cy:"19",r:"2"}),r.createElement("circle",{fill:"#FFCC4D",cx:"26",cy:"23",r:"2"}))),_(r.createElement(r.Fragment,null,r.createElement("path",{fill:"#FFD983",d:"M36 18c0 9.941-8.059 18-18 18c-.294 0-.58-.029-.87-.043C11.239 33.393 7 26.332 7 18C7 9.669 11.239 2.607 17.13.044C17.42.03 17.706 0 18 0c9.941 0 18 8.059 18 18z"}),r.createElement("path",{fill:"#66757F",d:"M7 18C7 9.669 11.239 2.607 17.13.044C7.596.501 0 8.353 0 18c0 9.646 7.594 17.498 17.128 17.956C11.238 33.391 7 26.331 7 18z"}),r.createElement("circle",{fill:"#FFCC4D",cx:"25.5",cy:"8.5",r:"3.5"}),r.createElement("circle",{fill:"#FFCC4D",cx:"16",cy:"16",r:"3"}),r.createElement("circle",{fill:"#FFCC4D",cx:"14.5",cy:"27.5",r:"3.5"}),r.createElement("circle",{fill:"#FFCC4D",cx:"15",cy:"6",r:"2"}),r.createElement("circle",{fill:"#FFCC4D",cx:"33",cy:"18",r:"1"}),r.createElement("circle",{fill:"#5B6876",cx:"6",cy:"9",r:"1"}),r.createElement("circle",{fill:"#FFCC4D",cx:"21",cy:"31",r:"1"}),r.createElement("circle",{fill:"#5B6876",cx:"4",cy:"19",r:"2"}),r.createElement("circle",{fill:"#FFCC4D",cx:"26",cy:"23",r:"2"})))],G=({className:e})=>{const[t,a]=r.useState(0);return r.useEffect((()=>{let e=setInterval((()=>{a((e=>a((e+1)%H.length)))}),100);return()=>clearInterval(e)}),[]),r.createElement("div",{className:e},H[t])};class W{constructor(e){this.signalSocket=e,this.target=new EventTarget}addEventListener(e,t){this.target.addEventListener(e,t)}removeEventListener(e,t){this.target.removeEventListener(e,t)}async bootstrap(e){try{await this.doBootstrap(e)}catch(t){E.error("[receiver-data-channel-bootstrapper] error",t)}}async doBootstrap(e){this.connection=v(e),this.connection.ondatachannel=({channel:e})=>this.target.dispatchEvent(new CustomEvent("channel-open",{detail:{channel:e}})),p(this.connection,this.signalSocket),this.signalSocket.on("SIGNAL_OFFER",(({offer:e})=>this.handleOffer(e)))}async handleOffer(e){console.assert(e),E.info("[receiver-data-channel-bootstrapper] received remote offer:",e),await this.connection.setRemoteDescription(new RTCSessionDescription(e));const t=await this.connection.createAnswer();await this.connection.setLocalDescription(t),this.signalSocket.emit("SIGNAL_ANSWER",{answer:t}),this.target.dispatchEvent(new CustomEvent("answer-sent"))}}class P{constructor(e){this.target=new EventTarget,e.onmessage=({data:e})=>this.onReceiveData(e),e.onclose=()=>this.onChannelClose(),this.reset()}addEventListener(e,t){this.target.addEventListener(e,t)}removeEventListener(e,t){this.target.removeEventListener(e,t)}receive(e){return new Promise((async(t,r)=>{try{await this.doReceive(e,t)}catch(a){E.error("[data-channel-receiver] error",a),r(a)}}))}async doReceive(e,t){this.reset(e,t)}onReceiveData(e){if(!this.currentResolve)return void E.error("[data-channel-receiver] ignored newly received arraybuffer");const t=e.byteLength,r=new Uint8Array(e);for(let a=0;a<t;a++)this.arrayBufferView[this.receivedBytes+a]=r[a];this.receivedBytes+=t,this.target.dispatchEvent(new CustomEvent("progress",{detail:{newlyReceivedBytes:t}})),this.receivedBytes===this.totalBytes&&(E.debug(`[data-channel-receiver] successfully received ${this.receivedBytes}bytes of data`),console.assert(this.currentResolve),this.target.dispatchEvent(new CustomEvent("receive-completed")),this.currentResolve(this.arrayBuffer),this.reset())}onChannelClose(){this.receivedBytes<this.totalBytes&&this.target.dispatchEvent(new CustomEvent("channel-closed",{detail:{receivedBytes:this.receivedBytes,totalBytes:this.totalBytes}}))}reset(e=0,t=null){this.currentResolve=t,this.totalBytes=e,this.arrayBuffer=new ArrayBuffer(e),this.arrayBufferView=new Uint8Array(this.arrayBuffer),this.receivedBytes=0}}class Y{constructor(){this.last=0,this.current=0,this.goal=0,this.startTimestamp=0,this.cancelled=!0,this.target=new EventTarget}addEventListener(e,t){this.target.addEventListener(e,t)}removeEventListener(e,t){this.target.removeEventListener(e,t)}addToCurrent(e){this.current+=e}start(e){this.last=this.current=0,this.goal=e,this.cancelled=!1,this.startTimestamp=Date.now(),setTimeout((()=>this.emitSpeed()),1e3)}cancel(){this.target.dispatchEvent(new CustomEvent("transfer-speed-update",{detail:this.speedSnapshot()})),this.cancelled=!0}speedSnapshot(){const e=this.current-this.last;return{current:this.current,goal:this.goal,speed:Math.round(e/1),avgSpeed:Math.round(this.current/((Date.now()-this.startTimestamp)/1e3))}}emitSpeed(){if(this.current===this.goal||this.cancelled)return;const e=this.speedSnapshot();this.last=this.current,this.target.dispatchEvent(new CustomEvent("transfer-speed-update",{detail:e})),setTimeout((()=>this.emitSpeed()),1e3)}}class X{constructor(e){this.receiver=new P(e),this.target=new EventTarget,this.speedMonitor=new Y}addEventListener(e,t){this.target.addEventListener(e,t)}removeEventListener(e,t){this.target.removeEventListener(e,t)}async receiveSingleFile(){const e=T(await this.receiver.receive(16384));this.target.dispatchEvent(new CustomEvent("meta-received",{detail:{meta:e}})),E.info("[file-receiver] got meta:",e);const t=({detail:{newlyReceivedBytes:e}})=>this.speedMonitor.addToCurrent(e),r=()=>this.speedMonitor.cancel();this.receiver.addEventListener("progress",t),this.receiver.addEventListener("receive-completed",r),console.assert(this.speedMonitor.cancelled),this.speedMonitor.start(e.size);const a=await this.receiver.receive(e.size);return this.target.dispatchEvent(new CustomEvent("file-received")),E.info("[file-receiver] successfully received a file"),this.receiver.removeEventListener("progress",t),this.receiver.removeEventListener("receive-completed",r),{meta:e,fileBuffer:a}}async*receiveFiles(){for(;;)yield await this.receiveSingleFile()}}function q(e,t,r){const a=document.createElement("a");a.style.display="none";const n=URL.createObjectURL(new Blob([e],{type:r}));a.href=n,a.download=t,a.type=r,document.body.append(a),a.click(),URL.revokeObjectURL(n),document.body.removeChild(a)}const J=({socket:e,serversInfo:t,errorMessage:a})=>{const[n,c]=r.useState(null),[l,s]=r.useState(null),[i,o]=r.useState("initial"),[m,h]=r.useState({speed:0,progress:0,current:0});return r.useEffect((()=>{const r=new W(e);r.addEventListener("answer-sent",(()=>o("connected"))),r.addEventListener("channel-open",(async({detail:{channel:e}})=>{const t=new X(e);s(t),o("ready");for await(const{meta:r,fileBuffer:a}of t.receiveFiles())q(a,r.name,r.type)})),r.bootstrap(t).then((()=>e.connect()))}),[]),r.useEffect((()=>{if(!l||!e)return;l.addEventListener("meta-received",(({detail:{meta:e}})=>{o("transferring"),c(e)})),l.addEventListener("file-received",(()=>o("completed")));const{speedMonitor:t}=l;t.addEventListener("transfer-speed-update",(({detail:{avgSpeed:t,speed:r,current:a,goal:n}})=>{h({speed:r,avgSpeed:t,progress:Math.floor(100*a/n),current:a}),e.emit("EVENT_RECEIVER_PROGRESS",{avgSpeed:t,speed:r,current:a,goal:n})}))}),[l,e]),r.createElement("main",{className:"p-2 grid grid-cols-2 grid-rows-1 gap-4"},r.createElement("div",{className:"flex flex-col items-center"},r.createElement("h4",{className:"text-gray-200 font-zcool text-3xl tracking-widest mb-2 xl:mb-4"},"发送文件"),!a&&r.createElement(r.Fragment,null,"initial"===i&&r.createElement(u,{className:"flex-1",message:"正在连接发送方..."}),"connected"===i&&r.createElement(u,{className:"flex-1",message:"正在尝试建立 WebRTC 连接..."}),"ready"===i&&r.createElement(u,{className:"flex-1",message:"连接成功建立，等待发送方选择文件并发送"}),"transferring"===i&&!n&&r.createElement(u,{className:"flex-1",message:"发送方开始发送文件，等待元数据..."}),"transferring"===i&&n&&r.createElement(d,{className:"flex-1",bottom:r.createElement("div",{className:"text-center text-sm p-2"},"正在发送...")},r.createElement(z,{name:n.name,size:n.size,type:n.type})),"completed"===i&&r.createElement(d,{className:"flex-1",bottom:r.createElement("div",{className:"text-center text-sm p-2"},"发送完成")},r.createElement(z,{name:n.name,size:n.size,type:n.type}))),a&&r.createElement($,{className:"flex-1 w-full",message:a})),r.createElement("div",{className:"flex flex-col items-center"},r.createElement("h4",{className:"text-gray-200 font-zcool text-3xl tracking-widest mb-2 xl:mb-4"},"接收文件"),!n&&r.createElement(y,{className:"flex-1 text-gray-400 w-full"},"等待中..."),n&&r.createElement(D,{className:"flex-1",fileName:n.name,receivedSize:m.current,type:n.type,progress:m.progress,speed:m.speed,avgSpeed:m.avgSpeed})))},K=e.p`
  margin: 4px 0;
`,Q=()=>{const[e,t]=r.useState([]);return r.useEffect((()=>{E.addEventListener("new-log",(({detail:e})=>{t((t=>[...t,e]))}))}),[]),r.createElement("div",{className:"m-2 p-1 pr-0 sm:p-2 absolute inset-0 text-xs font-mono break-all bg-gray-800 overflow-auto rounded"},e.map((({level:e,line:t})=>r.createElement(K,{key:t,className:"debug"===e?"text-gray-500":"error"===e?"text-pink-700":""},t))))},Z=e.div`
  scroll-snap-type: y mandatory;
`,ee=({iceServersInfo:e=[]})=>r.createElement("div",{className:"absolute inset-0"},r.createElement(Z,{className:"p-2 mx-auto h-full flex flex-col items-center overflow-auto overscroll-auto"},e.map((({id:e,url:t,displayName:a,description:n})=>r.createElement("div",{key:e,className:"px-4 py-2 flex-col my-2 bg-gray-800 rounded w-full max-w-[32rem] shadow"},r.createElement("div",{className:"flex-1 flex justify-between items-baseline mb-1"},r.createElement("p",{className:"mr-4 font-bold"},a),r.createElement("p",{className:"font-mono italic text-gray-500 text-xs max-w-[12rem] truncate"},t)),r.createElement("div",{className:"flex-1 text-sm max-h-[2.5rem] overflow-auto break-all text-gray-400"},n)))))),te=new URLSearchParams(window.location.search).get("id"),re=!te,ae=e.div`
  background-color: #111827;
  background-image: url("data:image/svg+xml,%3Csvg width='128' height='128' viewBox='0 0 64 64' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M8 16c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zm0-2c3.314 0 6-2.686 6-6s-2.686-6-6-6-6 2.686-6 6 2.686 6 6 6zm33.414-6l5.95-5.95L45.95.636 40 6.586 34.05.636 32.636 2.05 38.586 8l-5.95 5.95 1.414 1.414L40 9.414l5.95 5.95 1.414-1.414L41.414 8zM40 48c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zm0-2c3.314 0 6-2.686 6-6s-2.686-6-6-6-6 2.686-6 6 2.686 6 6 6zM9.414 40l5.95-5.95-1.414-1.414L8 38.586l-5.95-5.95L.636 34.05 6.586 40l-5.95 5.95 1.414 1.414L8 41.414l5.95 5.95 1.414-1.414L9.414 40z' fill='%239ca3af' fill-opacity='0.06' fill-rule='evenodd'/%3E%3C/svg%3E");
`,ne=e.h2`
  background: -webkit-linear-gradient(#e5e7eb 40%, #9ca3af 70%, #6b7280);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
`,ce=()=>{const[e,t]=r.useState(te),[a,n]=r.useState(null),[c,i]=r.useState(null),[o,m]=r.useState(!1),[d,h]=r.useState(!1),[f,u]=r.useState(null),p=r.useMemo((()=>!a||!c),[a,c]);return r.useEffect((()=>{window.onerror=function(e,t,r,a,n){E.error("[App] caught javascript runtime error",{message:e,url:t,lineNo:r,columnNo:a,error:n}),h(!0)}}),[]),r.useEffect((()=>{a&&window.addEventListener("unload",(()=>a.close()))}),[a]),r.useEffect((()=>{let r;if(re){const e=l(6);r=function(e){return s({transports:["websocket"],path:"/signal/sender",query:{jobId:e},...O})}(e),E.debug("[App] connecting to signal server as sender, jobId:",e),t(e)}else r=function(e){return s({transports:["websocket"],path:"/signal/receiver",query:{jobId:e},...O})}(e),E.debug("[App] connecting to signal server as receiver, jobId:",e);r.on("ERROR",(({message:e})=>{E.error("[App] got error from signal server",e),u(e)})),r.on("EVENT_PEER_LEFT",(()=>{E.info("[App] the peer has left"),u("对方已经关闭俊俊快传")})),r.on("disconnect",(e=>{E.info("[App] disconnected from signal server, reason:",e),["io server disconnect","io client disconnect"].includes(e)&&u((t=>`信令连接已断开：${e}${t?`（${t}）`:""}`))})),r.on("connect",(()=>{E.info("[App] connected to signal server")})),n(r)}),[]),r.useEffect((async()=>{const e=await fetch("/ice"),t=await e.json();E.debug("[App] got ice info",t),i(t)}),[]),r.createElement(ae,{className:"bg-gray-900 relative"},r.createElement("div",{className:"max-w-[850px] mx-auto h-screen flex flex-col"},r.createElement("div",{className:"relative z-10 flex-none text-center text-gray-300 my-4 xl:my-6"},r.createElement(ne,{className:"text-gray-200 font-zcool text-6xl sm:text-8xl tracking-wider mb-2"},"俊俊快传"),r.createElement("p",{className:"text-sm sm:text-xl text-gray-400 tracking-wider"},"基于 WebRTC 技术的浏览器点对点文件传输工具"),r.createElement("p",{className:"flex items-center justify-center text-sm"},r.createElement("a",{href:"https://github.com/darkyzhou/junjun-transfer",className:"inline-block text-gray-400 leading-5 hover:text-gray-200 transition-colors mr-2"},r.createElement("span",{className:"inline-flex self-center pr-1"},r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",className:"h-[1em] relative top-[0.125em] inline-block","aria-hidden":"true",role:"img",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},r.createElement("path",{d:"M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33c.85 0 1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2z",fill:"currentColor"}))),"GitHub 仓库"),r.createElement("a",{href:"https://github.com/darkyzhou/junjun-transfer",className:"pb-1"},r.createElement("img",{className:"inline",src:"https://img.shields.io/github/stars/darkyzhou/junjun-transfer?style=social"})))),r.createElement("div",{className:"relative z-10 flex-none"},p&&r.createElement("main",{className:"p-12 text-gray-300 flex flex-col items-center"},r.createElement(G,{className:"w-24 h-24 mb-4"}),r.createElement("p",{className:"text-xl"},"正在连接")),!p&&re&&r.createElement(V,{socket:a,jobId:e,serversInfo:c,errorMessage:f}),!p&&!re&&r.createElement(J,{socket:a,serversInfo:c,errorMessage:f})),r.createElement("div",{className:"flex-1 mx-auto text-gray-400 flex flex-col-reverse w-full items-center"},r.createElement("div",{className:"flex-none flex"},c&&r.createElement(w,{className:"mt-2 !px-2 !py-1 text-xs sm:text-sm flex-none rounded w-max mr-2",onClick:()=>{m(!o),h(!1)}},"查看 ICE 服务器"),r.createElement(w,{className:"mt-2 !px-2 !py-1 text-xs sm:text-sm flex-none rounded w-max",onClick:()=>{h(!d),m(!1)}},"查看日志")),r.createElement("div",{className:`flex-1 w-full rounded overflow-auto relative ${o&&"flex flex-col-reverse"}`,hidden:!o},r.createElement(ee,{iceServersInfo:null==c?void 0:c.servers})),r.createElement("div",{className:"flex-1 w-full relative rounded",hidden:!d},r.createElement(Q,null))),r.createElement("footer",{className:"relative z-10 flex-none text-center text-gray-400 p-2 text-xs sm:text-sm"},r.createElement("p",null,"Made with ❤️ by"," ",r.createElement("a",{href:"https://darkyzhou.net",className:"underline"},"darkyzhou")),r.createElement("p",null,"Emoji 图标来自 Twitter，遵循"," ",r.createElement("a",{className:"underline",href:"https://creativecommons.org/licenses/by/4.0/"},"CC-BY 4.0")," ","协议"),r.createElement("p",null,"猫咪图片来自 master1305、wirestock 和 winkimages"))))};window.addEventListener("beforeunload",(function(e){e.preventDefault(),e.returnValue=""})),i.render(r.createElement(r.StrictMode,null,r.createElement(ce,null)),document.getElementById("root"));
